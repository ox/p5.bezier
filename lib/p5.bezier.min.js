p5bezierAccuracyListAll=[.2,.1,.05,.04,.02,.01,.008,.002,.001,5e-4,1e-4],p5.prototype.newBezier=function(a,b,c=null){b=b||"OPEN",null==c&&(c=7);let e=p5bezierAccuracyListAll[c];if(!Array.isArray(a))throw"newBezier() function expects an array, got %s.",typeof a;else{let c=a[0].length;for(let b of a)if(!Array.isArray(a)||b.length!=c)throw"One or more points in the array are not input correctly.";"CLOSE"==b&&a.push(a[0]);let d=a.length,f=d-1;if(beginShape(),2==c){let b,c,d,g;for(d=0;1>=d;d+=e){for(b=0,c=0,g=0;g<=f;g++)b+=_helper_factorial(f)/(_helper_factorial(g)*_helper_factorial(f-g))*pow(1-d,f-g)*pow(d,g)*a[g][0],c+=_helper_factorial(f)/(_helper_factorial(g)*_helper_factorial(f-g))*pow(1-d,f-g)*pow(d,g)*a[g][1];vertex(b,c)}let h=a.slice(-1)[0];vertex(h[0],h[1])}else if(3==c){let b,c,g,d=[0,0,0];for(b=0;1>=b;b+=e){for(d[0]=0,d[1]=0,d[2]=0,c=0;c<=f;c++)for(g=0;3>g;g++)d[g]+=_helper_factorial(f)/(_helper_factorial(c)*_helper_factorial(f-c))*pow(1-b,f-c)*pow(b,c)*a[c][g];vertex(d[0],d[1],d[2])}let h=a.slice(-1)[0];vertex(h[0],h[1],h[2])}if("OPEN"==b)endShape();else if("CLOSE"==b)endShape(CLOSE);else throw"Close Type Error. A bezier curve can only be either OPEN or CLOSE."}},p5.prototype.newBezierObj=function(a,b="OPEN",c=7){let d=p5bezierAccuracyListAll[c];if(!Array.isArray(a))throw"newBezier() function expects an array, got %s.",typeof a;else{let c=a[0].length;for(let b of a)if(!Array.isArray(a)||b.length!=c)throw"One or more points in the array are not input correctly.";let e=new BezierCurve(a,b,d,c);return e}};function _helper_factorial(b){if(0==b||1==b)return 1;return 1<b?b*_helper_factorial(b-1):void 0}class BezierCurve{constructor(a,b,c,d,e=null){if(2!=d&&3!=d)throw"Dimension Error. The bezier curve is %d-dimensional and doesn't belong to our world.",d;if(this.controlPoints=a,"CLOSE"==b)this.controlPoints.push(a[0]),this.closeType="CLOSE";else if("OPEN"==b)this.closeType="OPEN";else throw"Close Type Error. A bezier curve can only be either OPEN or CLOSE.";this.dimension=d,this.increment=c,this.vertexList=[],this.vertexListLen=0,this.p=this.controlPoints.length,this.n=this.p-1,null==e?this._buildVertexList():(this.vertexList=e,this.vertexListLen=this.vertexList.length)}_buildVertexList(){if(this.vertexList=[],2==this.dimension){let a,b,c,d;for(c=0;1>=c;c+=this.increment){for(a=0,b=0,d=0;d<=this.n;d++)a+=_helper_factorial(this.n)/(_helper_factorial(d)*_helper_factorial(this.n-d))*pow(1-c,this.n-d)*pow(c,d)*this.controlPoints[d][0],b+=_helper_factorial(this.n)/(_helper_factorial(d)*_helper_factorial(this.n-d))*pow(1-c,this.n-d)*pow(c,d)*this.controlPoints[d][1];this.vertexList.push([a,b])}}else if(3==this.dimension){let a,b,c,d=[0,0,0];for(a=0;1>=a;a+=this.increment){for(d[0]=0,d[1]=0,d[2]=0,b=0;b<=this.n;b++)for(c=0;3>c;c++)d[c]+=_helper_factorial(this.n)/(_helper_factorial(b)*_helper_factorial(this.n-b))*pow(1-a,this.n-b)*pow(a,b)*this.controlPoints[b][c];this.vertexList.push(d)}}let a=this.controlPoints.slice(-1)[0];return this._addVertex(a),this.dimension=this.vertexList[0].length,this.vertexListLen=this.vertexList.length,this.vertexList}_addVertex(a){if(2==this.dimension)vertex(a[0],a[1]);else if(3==this.dimension)vertex(a[0],a[1],a[2]);else throw"Vertices can only be in 2D or 3D space."}_distVertex(a,b){if(2==this.dimension)return dist(a[0],a[1],b[0],b[1]);return 3==this.dimension?dist(a[0],a[1],a[2],b[0],b[1],b[2]):void 0}draw(a=0){if(0==a){beginShape();for(let a of this.vertexList)this._addVertex(a);"OPEN"==this.closeType?endShape():"CLOSE"==this.closeType&&endShape(CLOSE)}else if(Array.isArray(a)&&2==a.length&&.008>=this.increment){let b=abs(a[0]),c=b+abs(a[1]),d=0,e=0,f=this.vertexList[0],g=!0;push(),noFill(),beginShape(),this._addVertex(this.vertexList[0]);for(let a=1;a<this.vertexListLen;a++)d+=this._distVertex(f,this.vertexList[a]),e=d%c,e<=b&&g?this._addVertex(this.vertexList[a]):e>b&&e<=c&&g?(endShape(),g=!1):e<=b&&!g&&(beginShape(),this._addVertex(this.vertexList[a]),g=!0),f=this.vertexList[a];g&&endShape(),pop()}else if(.008<this.increment)throw"Fidelity is too low for a dash line. It should be at least 6.";else throw"Your dash array input is not valid. Make sure it's an array of two numbers."}update(a){if(a.length!=this.controlPoints)throw"The number of points changed. (Keep the point array length the same.)";else if(this.controlPoints==a);else this.controlPoints=a,this._buildVertexList()}move(a,b,c=null,d=!0,e=0){if(null==c&&3==this.dimension)throw"To move a 3D curve, please specify (x, y, z).";else{let f=[a,b];null!=c&&f.push(c);let g=[];for(let a=0;a<this.vertexListLen;a++)g.push(this.vertexList[a].slice());let h=new BezierCurve(this.controlPoints,this.closeType,this.increment,this.dimension,g);for(let a=0;a<h.vertexListLen;a++)for(let b=0;b<h.dimension;b++)h.vertexList[a][b]+=f[b];return d&&h.draw(e),h}}shortest(a,b,c=0){let d,e=-1,f=0;for(let g of this.vertexList)-1==e?(e=this._distVertex(g,[a,b,c]),d=g):(f=this._distVertex(g,[a,b,c]),e>f&&(e=f,d=g));return d}}